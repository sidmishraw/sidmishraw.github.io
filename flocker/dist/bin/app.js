!function(t){var e={};function i(o){if(e[o])return e[o].exports;var r=e[o]={i:o,l:!1,exports:{}};return t[o].call(r.exports,r,r.exports,i),r.l=!0,r.exports}i.m=t,i.c=e,i.d=function(t,e,o){i.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:o})},i.r=function(t){Object.defineProperty(t,"__esModule",{value:!0})},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=1)}([function(t,e){t.exports=p5},function(t,e,i){"use strict";i.r(e);i(0);var o=function(){function t(t,e,i){void 0===i&&(i=0),this.value=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]],this.xWrapAround=t,this.yWrapAround=e,this.currentScaleFactor={x:1,y:1,z:1},this.currentRotationAngle=i}return t.strassen2x2=function(t,e){if(!t||!e)throw new Error("A and B need to be 2x2 matrices.");var i=t[0][0]*(e[0][1]-e[1][1]),o=(t[0][0]+t[0][1])*e[1][1],r=(t[1][0]+t[1][1])*e[0][0],n=t[1][1]*(e[1][0]-e[0][0]),a=(t[0][0]+t[1][1])*(e[0][0]+e[1][1]);return[[a+n-o+(t[0][1]-t[1][1])*(e[1][0]+e[1][1]),i+o],[r+n,i+a-r-(t[0][0]-t[1][0])*(e[0][0]+e[0][1])]]},t.strassen4x4=function(e,i){if(!e||!i)throw new Error("A and B need to be 4x4 matrices.");var o=[[e[0][0],e[0][1]],[e[1][0],e[1][1]]],r=[[e[0][2],e[0][3]],[e[1][2],e[1][3]]],n=[[e[2][0],e[2][1]],[e[3][0],e[3][1]]],a=[[e[2][2],e[2][3]],[e[3][2],e[3][3]]],s=[[i[0][0],i[0][1]],[i[1][0],i[1][1]]],c=[[i[0][2],i[0][3]],[i[1][2],i[1][3]]],l=[[i[2][0],i[2][1]],[i[3][0],i[3][1]]],h=[[i[2][2],i[2][3]],[i[3][2],i[3][3]]],u=t.strassen2x2(o,t.matrixDiff2x2(c,h)),p=t.strassen2x2(t.matrixSum2x2(o,r),h),d=t.strassen2x2(t.matrixSum2x2(n,a),s),f=t.strassen2x2(a,t.matrixDiff2x2(l,s)),m=t.strassen2x2(t.matrixSum2x2(o,a),t.matrixSum2x2(s,h)),w=t.strassen2x2(t.matrixDiff2x2(r,a),t.matrixSum2x2(l,h)),x=t.strassen2x2(t.matrixDiff2x2(o,n),t.matrixSum2x2(s,c)),g=t.matrixSum2x2(t.matrixDiff2x2(t.matrixSum2x2(m,f),p),w),y=t.matrixSum2x2(d,f),v=t.matrixSum2x2(u,p),k=t.matrixDiff2x2(t.matrixSum2x2(u,m),t.matrixSum2x2(d,x));return[g[0].concat(v[0]),g[1].concat(v[1]),y[0].concat(k[0]),y[1].concat(k[1])]},t.matrixSum2x2=function(t,e){if(!t||!e)throw new Error("A and B need to be 2x2 matrices.");return[[t[0][0]+e[0][0],t[0][1]+e[0][1]],[t[1][0]+e[1][0],t[1][1]+e[1][1]]]},t.matrixDiff2x2=function(t,e){if(!t||!e)throw new Error("A and B need to be 2x2 matrices.");return[[t[0][0]-e[0][0],t[0][1]-e[0][1]],[t[1][0]-e[1][0],t[1][1]-e[1][1]]]},t.prototype.resetMatrix=function(){this.value=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]]},t.prototype.getPosition=function(){return{x:this.value[0][3],y:this.value[1][3]}},t.prototype.getRotation=function(){return this.currentRotationAngle},t.prototype.getScale=function(){return this.currentScaleFactor},t.prototype.getParamsForApplying=function(){return[this.value[0][0],this.value[1][0],this.value[0][1],this.value[1][1],this.value[0][3],this.value[1][3]]},t.prototype.multMatrix=function(e){return t.strassen4x4(e,this.value)},t.prototype.translate2D=function(t,e){if(!isNaN(t)&&!isNaN(e)&&t&&e){var i=[[1,0,0,t],[0,1,0,e],[0,0,1,0],[0,0,0,1]];this.value=this.multMatrix(i),this.xWrapAround&&this.yWrapAround&&(this.value[0][3]<0&&(this.value[0][3]=this.xWrapAround+this.value[0][3]),this.value[0][3]>this.xWrapAround&&(this.value[0][3]=this.value[0][3]-this.xWrapAround),this.value[1][3]<0&&(this.value[1][3]=this.yWrapAround+this.value[1][3]),this.value[1][3]>this.yWrapAround&&(this.value[1][3]=this.value[1][3]-this.yWrapAround))}},t.prototype.scale2D=function(t,e){if(!isNaN(t)&&!isNaN(e)&&t&&e){this.currentScaleFactor.x=this.currentScaleFactor.x*t,this.currentScaleFactor.y=this.currentScaleFactor.y*e;var i=[[t,0,0,0],[0,e,0,0],[0,0,1,0],[0,0,0,1]];this.value=this.multMatrix(i)}},t.prototype.rotate2D=function(t){if(!isNaN(t)&&t){this.currentRotationAngle=(this.currentRotationAngle+t)%360;var e=Math.cos(t),i=Math.sin(t),o=[[e,-i,0,0],[i,e,0,0],[0,0,1,0],[0,0,0,1]];this.value=this.multMatrix(o)}},t.prototype.rRotate2D=function(t){if(!isNaN(t)&&t){var e=Math.cos(this.currentRotationAngle),i=Math.sin(this.currentRotationAngle),o=[[e,i,0,0],[-i,e,0,0],[0,0,1,0],[0,0,0,1]];this.currentRotationAngle=t;var r=[[e=Math.cos(t),-(i=Math.sin(t)),0,0],[i,e,0,0],[0,0,1,0],[0,0,0,1]];this.value=this.multMatrix(o),this.value=this.multMatrix(r)}},t}(),r=function(){function t(e,i,r){t.idGen++,this.id=t.idGen,this.flocker=r,this.image=this.flocker.$p5.loadImage(this.flocker.$imagePath);var n=this.flocker.$p5.random(360);this.position=this.flocker.$p5.createVector(e,i),this.velocity=this.flocker.$p5.createVector(Math.cos(n),Math.sin(n)),this.acceleration=this.flocker.$p5.createVector(0,0),this.m=new o(this.flocker.$maxWrapAroundWidth,this.flocker.$maxWrapAroundHeight,33.56),this.m.scale2D(.18,.18),this.m.translate2D(this.position.x,this.position.y),this.maxAcceleration=this.flocker.$maxAcceleration,this.maxVelocity=this.flocker.$maxVelocity}return t.prototype.fly=function(){var t=this.separation(),e=this.alignment(),i=this.cohesion();t.mult(this.flocker.$separationWeight),e.mult(this.flocker.$alignmentWeight),i.mult(this.flocker.$cohesionWeight),this.applyForce(t),this.applyForce(e),this.applyForce(i),this.velocity.add(this.acceleration),this.velocity.limit(this.maxVelocity),this.position.add(this.velocity),this.m.translate2D(this.velocity.x,this.velocity.y),this.acceleration.mult(0),this.render()},t.prototype.seek=function(t){var e=this.m.getPosition(),i=t.sub(this.flocker.$p5.createVector(e.x,e.y));i.normalize(),i.mult(this.maxVelocity);var o=i.sub(this.velocity);return o.limit(this.maxAcceleration),o},t.prototype.separation=function(){var t=this,e=this.flocker.$desiredSeparation,i=this.flocker.$p5.createVector(0,0),o=0;return this.flocker.$swallows.forEach(function(r){var n=t.flocker.$p5.createVector(t.m.getPosition().x,t.m.getPosition().y),a=t.flocker.$p5.createVector(r.m.getPosition().x,r.m.getPosition().y),s=n.dist(a);if(s>0&&s<e){var c=n.sub(a);c.normalize(),c.div(s),i.add(c),o++}}),o>0&&i.div(o),i.mag()>0&&(i.normalize(),i.mult(this.maxVelocity),i.sub(this.velocity),i.limit(this.maxAcceleration)),i},t.prototype.alignment=function(){var t=this,e=this.flocker.$desiredAlignment,i=this.flocker.$p5.createVector(0,0),o=0;this.flocker.$swallows.forEach(function(r){var n=t.flocker.$p5.createVector(t.m.getPosition().x,t.m.getPosition().y),a=t.flocker.$p5.createVector(r.m.getPosition().x,r.m.getPosition().y),s=n.dist(a);s>0&&s<e&&(i.add(r.velocity),o++)});var r=this.flocker.$p5.createVector(0,0);return o>0&&(i.div(o),i.normalize(),i.mult(this.maxVelocity),(r=i.sub(this.velocity)).limit(this.maxAcceleration)),r},t.prototype.cohesion=function(){var t=this,e=this.flocker.$desiredCohesion,i=this.flocker.$p5.createVector(0,0),o=0;this.flocker.$swallows.forEach(function(r){var n=t.flocker.$p5.createVector(t.m.getPosition().x,t.m.getPosition().y),a=t.flocker.$p5.createVector(r.m.getPosition().x,r.m.getPosition().y),s=n.dist(a);s>0&&s<e&&(i.add(a),o++)});var r=this.flocker.$p5.createVector(0,0);return o>0&&(i.div(o),r=this.seek(i)),r},t.prototype.changeDirection=function(){this.m.rotate2D(Math.abs(.1))},t.prototype.applyForce=function(t){this.acceleration.add(t)},t.prototype.render=function(){this.flocker.$p5.push();var t=this.m.getParamsForApplying(),e=t[0],i=t[1],o=t[2],r=t[3],n=t[4],a=t[5];this.flocker.$p5.applyMatrix(e,i,o,r,n,a),this.flocker.$p5.rotate(this.velocity.heading()+90),this.flocker.$p5.image(this.image,0,0),this.flocker.$p5.pop()},t.idGen=0,t}(),n=function(){function t(t){this.maxWrapAroundWidth=816,this.maxWrapAroundHeight=480,this.maxVelocity=2,this.maxAcceleration=.03,this.desiredSeparation=50,this.desiredAlignment=50,this.desiredCohesion=50,this.separationWeight=3,this.alignmentWeight=2,this.cohesionWeight=2,this.swallows=[],this.p5=t,this.imagePath="/flocker/resources/swallow.png"}return Object.defineProperty(t.prototype,"$imagePath",{get:function(){return this.imagePath},set:function(t){this.imagePath=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"$maxWrapAroundWidth",{get:function(){return this.maxWrapAroundWidth},set:function(t){this.maxWrapAroundWidth=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"$maxVelocity",{get:function(){return this.maxVelocity},set:function(t){this.maxVelocity=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"$maxWrapAroundHeight",{get:function(){return this.maxWrapAroundHeight},set:function(t){this.maxWrapAroundHeight=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"$maxAcceleration",{get:function(){return this.maxAcceleration},set:function(t){this.maxAcceleration=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"$desiredSeparation",{get:function(){return this.desiredSeparation},set:function(t){this.desiredSeparation=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"$desiredAlignment",{get:function(){return this.desiredAlignment},set:function(t){this.desiredAlignment=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"$desiredCohesion",{get:function(){return this.desiredCohesion},set:function(t){this.desiredCohesion=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"$separationWeight",{get:function(){return this.separationWeight},set:function(t){this.separationWeight=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"$alignmentWeight",{get:function(){return this.alignmentWeight},set:function(t){this.alignmentWeight=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"$cohesionWeight",{get:function(){return this.cohesionWeight},set:function(t){this.cohesionWeight=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"$swallows",{get:function(){return this.swallows},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"$p5",{get:function(){return this.p5},enumerable:!0,configurable:!0}),t.prototype.resetSimulation=function(){this.swallows=[]},t.prototype.addSwallow=function(t,e){t<0||t>this.maxWrapAroundWidth||e<0||e>this.maxWrapAroundHeight||this.swallows.push(new r(t,e,this))},t.prototype.removeSwallow=function(){this.swallows.length<=30||this.swallows.splice(0,1)},t.prototype.simulate=function(){this.swallows.forEach(function(t){return t.fly()})},t.prototype.drawGrid=function(){this.p5.stroke("#000000"),this.p5.fill(this.p5.color(120)),this.p5.textSize(10),this.p5.textAlign(this.p5.LEFT,this.p5.CENTER),this.p5.textFont("Courier New");for(var t=-this.p5.width;t<this.p5.width;t+=40)this.p5.line(t,-this.p5.height,t,this.p5.height),this.p5.text(t.toString(),t+1,12);for(var e=-this.p5.height;e<this.p5.height;e+=40)this.p5.line(-this.p5.width,e,this.p5.width,e),this.p5.text(e.toString(),1,e+12)},t}();i.d(e,"simulationNode",function(){return a});var a="flocker";new p5(function(t){window.flocker=new n(t),window.flocker_sP5=t,t.setup=function(){t.createCanvas(window.flocker.$maxWrapAroundWidth,window.flocker.$maxWrapAroundHeight);t.angleMode(t.DEGREES),t.rectMode(t.CENTER),t.imageMode(t.CENTER),window.flocker.resetSimulation();for(var e=0;e<30;e++)window.flocker.addSwallow(t.random(window.flocker.$maxWrapAroundWidth),t.random(window.flocker.$maxWrapAroundHeight))},t.draw=function(){t.clear(),window.flocker.simulate(),t.textSize(10),t.textAlign(t.LEFT,t.CENTER),t.textFont("Courier New"),t.text("Frame rate: "+t.frameRate()+" FPS\nSwallow count: "+window.flocker.$swallows.length,10,20),window.debugView&&window.flocker.drawGrid(),window.metaControl&&(t.textSize(22),t.textAlign(t.CENTER,t.CENTER),t.textFont("Courier New"),t.text("Ctrl + r: Remove a swallow from simulation\nCtrl + d: Toggle debug view\nCtrl + c: Add a swallow at the center of canvas",t.windowWidth/2-200,t.windowHeight/2))},t.mouseReleased=function(){window.flocker.addSwallow(t.mouseX,t.mouseY)},t.windowResized=function(){t.resizeCanvas(window.flocker.$maxWrapAroundWidth,window.flocker.$maxWrapAroundHeight,!0),window.flocker.resetSimulation();for(var e=0;e<30;e++)window.flocker.addSwallow(t.random(window.flocker.$maxWrapAroundWidth),t.random(window.flocker.$maxWrapAroundHeight))},t.keyPressed=function(){17===t.keyCode&&(window.metaControl=!0)},t.keyReleased=function(){return 17===t.keyCode&&(window.metaControl=!1),68===t.keyCode&&window.metaControl&&(window.debugView=!window.debugView),67===t.keyCode&&window.metaControl&&window.flocker.addSwallow(window.flocker.$maxWrapAroundWidth/2,window.flocker.$maxWrapAroundHeight/2),82===t.keyCode&&window.metaControl&&window.flocker.removeSwallow(),!1}},document.getElementById(a))}]);